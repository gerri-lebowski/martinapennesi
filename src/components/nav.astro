---
const menu = [
  { label: 'Home', href: '/' },
  { label: 'Chi sono', href: '/chi-sono' },
  { label: 'Terapia', href: '/terapia' },
  { label: 'Contatti', href: '/contatti' }
];
---

<nav class="navbar">
  <ul class="desktop-menu">
    {menu.map((item) => (
      <li><a href={item.href}>{item.label}</a></li>
    ))}
  </ul>

  <!-- hamburger -->
  <div class="hamburger" id="hamburger">
    <div class="line"></div>
    <div class="line"></div>
    <div class="line"></div>
  </div>

  <!-- mobile menu -->
  <div class="mobile-menu" id="mobileMenu">
    {menu.map((item) => (
      <a href={item.href}>{item.label}</a>
    ))}
  </div>
</nav>

<script>
  // Eseguito solo lato client
  document.addEventListener('DOMContentLoaded', () => {
    const hamburger = document.getElementById('hamburger');
    const mobileMenu = document.getElementById('mobileMenu');

    if (!hamburger || !mobileMenu) return;

    const closeMenu = () => {
      mobileMenu.classList.remove('open');
      hamburger.classList.remove('active');
    };

    const toggleMenu = () => {
      mobileMenu.classList.toggle('open');
      hamburger.classList.toggle('active');
    };

    hamburger.addEventListener('click', toggleMenu);

    // Chiudi al click su una voce di menu
    mobileMenu.querySelectorAll('a').forEach((link) => {
      link.addEventListener('click', closeMenu);
    });

    // Chiudi con ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeMenu();
    });

    // Chiudi se si torna a viewport desktop
    window.addEventListener('resize', () => {
      if (window.innerWidth > 768) closeMenu();
    });
  });
</script>

<style>
  nav.navbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
  }

  .desktop-menu {
    display: flex;
    gap: 2em;
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .hamburger {
    display: none;
    flex-direction: column;
    gap: 0.4rem;
    cursor: pointer;
    z-index: 20;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
  }

  .line {
    width: 24px;
    height: 2px;
    background-color: var(--clr-accent);
    transition: all 0.3s ease;
  }

  /* Animazione hamburger */
  .hamburger.active .line:nth-child(1) {
    transform: rotate(45deg) translateY(7px);
  }
  .hamburger.active .line:nth-child(2) {
    opacity: 0;
  }
  .hamburger.active .line:nth-child(3) {
    transform: rotate(-45deg) translateY(-7px);
  }

  /* Off-canvas mobile menu */
  .mobile-menu {
    position: fixed;
    top: 0;
    right: 0;
    height: 100vh;
    width: 280px;
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
    background-color: var(--clr-accent);
    color: var(--clr-white);
    padding: 2rem;
    box-shadow: -6px 0 24px rgba(0,0,0,0.2);
    transform: translateX(100%);
    opacity: 0;
    pointer-events: none;
    transition: transform 0.3s ease, opacity 0.3s ease;
    z-index: 15;
  }

  .mobile-menu a {
    color: var(--clr-white);
    text-decoration: none;
    font-size: 1.6rem;
  }

  .mobile-menu.open {
    transform: translateX(0);
    opacity: 1;
    pointer-events: auto;
  }

  @media (max-width: 768px) {
    .desktop-menu {
      display: none;
    }
    .hamburger {
      display: flex;
    }
  }
</style>
